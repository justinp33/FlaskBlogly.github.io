from unittest import TestCase

from app import app
from models import db, USER

# Use test database and don't clutter tests with SQL
app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql:///test_blogly_users_db'
app.config['SQLALCHEMY_ECHO'] = False

# Make Flask errors be real errors, rather than HTML pages with error info
app.config['TESTING'] = True

# This is a bit of hack, but don't use Flask DebugToolbar
app.config['DEBUG_TB_HOSTS'] = ['dont-show-debug-toolbar']

db.drop_all()
db.create_all()


class UserViewsTestCase(TestCase):
    """Tests for views for User."""

    def setUp(self):
        """Add sample user."""

        USER.query.delete()

        user = USER(first_name="Bob", last_name="Marley", image_url="data:image/jpeg;base64,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")
        db.session.add(user)
        db.session.commit()

        self.user_id = user.id
        self.user = user

    def tearDown(self):
        """Clean up any fouled transaction."""

        db.session.rollback()

    def test_list_users(self):
        with app.test_client() as client:
            resp = client.get("/")
            html = resp.get_data(as_text=True)

            self.assertEqual(resp.status_code, 200)
            self.assertIn('Bob', html)

    def test_show_user(self):
        with app.test_client() as client:
            resp = client.get(f"/{self.user_id}")
            html = resp.get_data(as_text=True)

            self.assertEqual(resp.status_code, 200)
            self.assertIn('<h1>Bob Marley</h1>', html)
            self.assertIn(self.image_url, html)
            

    def test_add_user(self):
        with app.test_client() as client:
            d = {"first_name": "John", "last_name": "Doe", "image_url": "data:image/jpeg;base64,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"}
            resp = client.post("/", data=d, follow_redirects=True)
            html = resp.get_data(as_text=True)

            self.assertEqual(resp.status_code, 200)
            self.assertIn("<h1>John Doe</h1>", html)
